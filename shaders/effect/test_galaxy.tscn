[gd_scene load_steps=4 format=2]

[ext_resource path="res://res/texture_galaxy_00.png" type="Texture" id=1]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;

uniform float speed:hint_range(.01,10.0) = 1.0;
uniform float scale:hint_range(.01,1.0) = 1.0;
uniform float distance:hint_range(.5,10.0) = 3.;

void fragment(){
	vec4 cc_all = vec4(vec3(.0),1.0);
	float scale_base = 1./scale/distance;
	
	float percent = fract(TIME*speed);
	
	for(int i=4;i>=1;i--){
		float i_seq_before = pow(2.,float(i));
		float i_seq = pow(2.,float(i+1));
		float scale_small = scale_base/i_seq_before;
		float scale_big = scale_base/i_seq;
		vec2 uv = ((UV-.5)*(percent*(scale_small-scale_big)+scale_big)+.5);
		vec4 cc = texture(TEXTURE, uv);
		if(i==1){
			cc.a *= 1.-smoothstep(0.0, 1.0 ,percent);
		}
		cc_all.rgb = cc_all.rgb*(1.-cc.a)+cc.rgb*cc.a;
	}
	COLOR = cc_all;
}"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )
shader_param/speed = 0.45
shader_param/scale = 0.05
shader_param/distance = 3.0

[node name="test_galaxy" type="Node2D"]

[node name="galaxy" type="Sprite" parent="."]
material = SubResource( 2 )
position = Vector2( 509.702, 312.981 )
scale = Vector2( 0.282701, 0.267166 )
texture = ExtResource( 1 )
